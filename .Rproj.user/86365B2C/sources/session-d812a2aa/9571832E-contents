

library(dplyr)
library(openxlsx) # práce s xlsx soubory, read.xlsx ()
# library(reschola)
library(tidyr) # transformace dat do tidy formátu https://github.com/rstudio/cheatsheets/blob/main/tidyr.pdf , drop_na()
library(janitor) # čištění dat, clean_names()
# library(stringr) # práce s textovýmni proměnnými
library(lubridate) # úprava datumů
library(RCzechia) # využívdata:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAWElEQVR42mNgGPTAxsZmJsVqQApgmGw1yApwKcQiT7phRBuCzzCSDSHGMKINIeDNmWQlA2IigKJwIssQkHdINgxfmBBtGDEBS3KCxBc7pMQgMYE5c/AXPwAwSX4lV3pTWwAAAABJRU5ErkJggg==á se hlavně pro tvrobu map, obsahuje szenam obcí, orp, krajů 
library(skimr) # souhrnné statistiky  
library(stats)
library(ggplot2)



# načtení dat  -------------------------------------------------------------

d <- readRDS("data/processed/dataset_clean.rds")

# grafy - base ------------------------------------------------------------

hist(d$obvykla_delka_spanku)

hist(d$obvykla_delka_spanku, col = "purple", 
     breaks = seq(4, 10, by = 0.5), 
     xlim = c(4, 10), 
     main = "Obyvklá délka spánku v hodinách", 
     xlab = "počet hodin", 
     ylab = "počet respondentů")
     
# Vytvoření histogramu s rozdílnými kategoriemi
ggplot(d, aes(x = obvykla_delka_spanku, fill = vzdelani_3kat)) +
  geom_histogram(binwidth = 1, position = "dodge", alpha = 0.5) +
  labs(title = "Obyvklá délka spánku v hodinách",
       x = "počet hodin",
       y = "počet respondentů",
       fill = "Vzdělání") +
  theme_minimal() +
  scale_fill_manual(values = c("red", "blue", "green")) # Nastavení barev pro jednotlivé kategorie

# Vytvoření histogramu s rozdílnými kategoriemi
ggplot(d, aes(x = obvykla_delka_spanku, fill = pohlavi)) +
  geom_histogram(binwidth = 1, position = "dodge", alpha = 0.5) +
  labs(title = "Obyvklá délka spánku v hodinách",
       x = "počet hodin",
       y = "počet respondentů",
       fill = "Vzdělání") +
  theme_minimal() +
  scale_fill_manual(values = c("red", "blue", "green")) # Nastavení barev pro jednotlivé kategorie

spanek_pohlavi <- d %>%
  group_by(pohlavi) %>%
  summarize(mean_spanek = round(mean(obvykla_delka_spanku, na.rm = TRUE), digits = 2))

spanek_vzdelani <- d %>%
  group_by(vzdelani_3kat) %>%
  summarize(mean_spanek = round(mean(obvykla_delka_spanku, na.rm = TRUE), digits = 2))

# Plot with main and axis titles
# Change point shape (pch = 19) and remove frame.
plot(d$vek, d$obvykla_delka_spanku,
     pch = 19, frame = FALSE)


# Add regression line
plot(x, y, main = "Main title",
     xlab = "X axis title", ylab = "Y axis title",
     pch = 19, frame = FALSE)
abline(lm(y ~ x, data = mtcars), col = "blue")